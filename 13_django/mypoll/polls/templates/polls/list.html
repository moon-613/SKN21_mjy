<!-- 'layout/main_layout.html' 레이아웃을 여기로 불러와라 라는 뜻 -->
{% extends 'layout/main_layout.html' %}

<!-- main_layout.html의 block에 넣을 내용들만 정의 -->
{% block title %}설문 목록{% endblock title %}
{% block contents %}
<h1>설문 목록</h1>
<ul class="list-group">
    <!-- 반복문 - 
        question_list(context_value:QuerySet)의 Question들을 출력 -->
    {% for question in question_list %}
        <li class="list-group-item list-group-item-action">
            <!-- <a href="/polls/vote_form/{{question.pk}}"> -->
            <a href="{% url 'polls:vote_form' question.pk %}" class="btn">

                {{question.pk}}. {{question.question_text|truncatewords:2}}  
                {# - 글자수: {{question.question_text | length}} - {{question.pub_date | date:'Y-m-d'}} #}  
                <!-- template 문법 필터 중 date 사용 -->
            </a>
            {% if user.is_authenticated %}
            <a href="{% url 'polls:vote_delete' question.pk %}" class="btn btn-danger btn-sm">질문 삭제</a>
            {% endif %} <!-- btn-sm: 버튼 작아짐. sm대신 lg하면 커짐.-->
        </li>
    {% empty %}
        {# 처음부터 question_list가 비어있으면 #}
        <b>아직 등록된 질문이 없습니다.</b>
    {% endfor %}
</ul>

<!-- paging 처리 - 페이지 링크들 출력 -->
<ul id="page_group" class="pagination mt-3">
    {# 이전 페이지 그룹으로 이동하는 버튼 #}
    {% if has_previous %}
        <li class="page-item">
            <a href="{% url 'polls:list' %}?page={{previous_page_number}}" class="page-link">
                이전
            </a>
        </li>
    {% else %}
        <li class="page-item disabled">
            <span class="page-link">이전</span>
        </li>
    {% endif %}

    {# 현재 페이지 그룹의 페이지로 이동하는 링크 - 현재 페이지는 링크를 걸지 않는다 #}

    {% for page_no in page_range %}
        <!-- question_list : Page객체 page객체.number -> 페이지 번호 -->
        {% if question_list.number == page_no %}
            <li class="page-item active">   <!-- active 하면 파란색으로 현재 있는 페이지에 표시가 됨 -->
                <span class="page-link">{{page_no}}</span>
            </li>
        {% else %}
            <li class="page-item">
                <a href="{% url 'polls:list' %}?page={{page_no}}" class="page-link">{{page_no}}</a>
            </li>
        {% endif %}
    {% endfor %}

    {# 다음 페이지 그룹으로 이동하는 버튼 #}
    {% if has_next %}
        <li class="page-item">
            <a href="{% url 'polls:list' %}?page={{next_page_number}}" class="page-link">
                다음 
            </a>
        </li>
    {% else %}
        <li class="page-item disabled">
            <span class="page-link">다음</span>
        </li>
    {% endif %}
</ul>
{% endblock contents %}